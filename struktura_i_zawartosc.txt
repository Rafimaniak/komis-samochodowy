Eksport wybranych plików
Wygenerowano: 12/06/2025 03:34:20



ŒCIE¯KA: C:\Users\Rafimaniaak\Downloads\komis-samochodowy — kopia (1)\komis-samochodowy — kopia\src\main\java\pl\komis\service\ZakupService.java
---------------------------------------------------------------------------------------------------------------------------------------------------
package pl.komis.service;

import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import pl.komis.model.*;
import pl.komis.repository.*;

import java.math.BigDecimal;
import java.time.LocalDate;
import java.util.List;

@Service
@RequiredArgsConstructor
public class ZakupService {

    private final ZakupRepository zakupRepository;
    public List<Zakup> findAll() {
        return zakupRepository.findAll();
    }
    private final SamochodService samochodService;
    private final KlientService klientService;
    private final PracownikService pracownikService;
    private final UserService userService;

    public Zakup createZakupFromSprzedaz(Long samochodId, Long userId, Long pracownikId, BigDecimal cena) {
        Samochod samochod = samochodService.findById(samochodId)
                .orElseThrow(() -> new RuntimeException("SamochÃ³d nie znaleziony"));

        User user = userService.findById(userId)
                .orElseThrow(() -> new RuntimeException("UÅ¼ytkownik nie znaleziony"));

        Klient klient = user.getKlient();
        if (klient == null) {
            throw new RuntimeException("UÅ¼ytkownik nie ma powiÄ…zanego klienta");
        }

        Pracownik pracownik = pracownikService.findById(pracownikId)
                .orElseThrow(() -> new RuntimeException("Pracownik nie znaleziony"));

        Zakup zakup = new Zakup();
        zakup.setSamochod(samochod);
        zakup.setKlient(klient);
        zakup.setPracownik(pracownik);
        zakup.setDataZakupu(LocalDate.now());
        zakup.setCenaZakupu(cena);

        return zakupRepository.save(zakup);
    }

    public Zakup save(Zakup zakup) {
        return zakupRepository.save(zakup);
    }

    public void remove(Long id) {
        zakupRepository.deleteById(id);
    }

    public List<Zakup> findByKlientId(Long id) {
        return zakupRepository.findByKlientId(id);
    }

    public List<Zakup> findByPracownikId(Long id) {
        return zakupRepository.findByPracownikId(id);
    }

    public List<Zakup> findByDateRange(LocalDate od, LocalDate do_) {
        return zakupRepository.findByDataZakupuBetween(od, do_);
    }
}

